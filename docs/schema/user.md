<!-- THIS FILE IS AUTOMATICALLY GENERATED, PLEASE DO NOT EDIT IT MANUALLY -->

# User

- [add](#add)
- [update](#update)
---

## Add

Contains the full state of users that the client has just subscribed to. This event should always precede [update](#update) events which contain partial updates of how users have changed.

- Endpoint Type: **Event**
- Source: **Server**
- Target: **User**
- Required Scopes: `tachyon.lobby`

### Event

<details>
<summary>JSONSchema</summary>

```json
{
    "title": "UserAddEvent",
    "scopes": [
        "tachyon.lobby"
    ],
    "type": "object",
    "properties": {
        "type": {
            "const": "event",
            "type": "string"
        },
        "messageId": {
            "type": "string"
        },
        "commandId": {
            "const": "user/add",
            "type": "string"
        },
        "data": {
            "type": "object",
            "properties": {
                "users": {
                    "type": "array",
                    "items": {
                        "$ref": "../../definitions/privateUser.json"
                    }
                }
            },
            "required": [
                "users"
            ],
            "title": "UserAddEventData"
        }
    },
    "required": [
        "type",
        "messageId",
        "commandId",
        "data"
    ]
}
```
</details>

<details>
<summary>Example</summary>

```json
{
    "type": "event",
    "messageId": "occaecat Lorem in",
    "commandId": "user/add",
    "data": {
        "users": [
            {
                "userId": "f47a7e1e-4b2f-4d3d-3f3c-1f0f0e4b7e1e",
                "username": "occaecat Lorem in",
                "displayName": "occaecat Lorem in",
                "clanId": "occaecat Lorem in",
                "partyId": "occaecat Lorem in",
                "scopes": [
                    "occaecat Lorem in",
                    "occaecat Lorem in",
                    "occaecat Lorem in"
                ],
                "countryCode": "occaecat Lorem in",
                "status": "menu",
                "battleStatus": {
                    "battleId": "occaecat Lorem in",
                    "isSpectator": true,
                    "name": "occaecat Lorem in",
                    "rank": -20000000,
                    "countryCode": "occaecat Lorem in"
                },
                "friendIds": [
                    "occaecat Lorem in",
                    "occaecat Lorem in",
                    "occaecat Lorem in"
                ],
                "outgoingFriendRequestIds": [
                    "occaecat Lorem in",
                    "occaecat Lorem in",
                    "occaecat Lorem in"
                ],
                "incomingFriendRequestIds": [
                    "occaecat Lorem in",
                    "occaecat Lorem in",
                    "occaecat Lorem in"
                ],
                "ignoreIds": [
                    "occaecat Lorem in",
                    "occaecat Lorem in",
                    "occaecat Lorem in"
                ]
            },
            {
                "userId": "f47a7e1e-4b2f-4d3d-3f3c-1f0f0e4b7e1e",
                "username": "occaecat Lorem in",
                "displayName": "occaecat Lorem in",
                "clanId": "occaecat Lorem in",
                "partyId": "occaecat Lorem in",
                "scopes": [
                    "occaecat Lorem in",
                    "occaecat Lorem in",
                    "occaecat Lorem in"
                ],
                "countryCode": "occaecat Lorem in",
                "status": "menu",
                "battleStatus": {
                    "battleId": "occaecat Lorem in",
                    "isSpectator": true,
                    "userId": {},
                    "name": "occaecat Lorem in",
                    "rank": -20000000,
                    "countryCode": "occaecat Lorem in"
                },
                "friendIds": [
                    "occaecat Lorem in",
                    "occaecat Lorem in",
                    "occaecat Lorem in"
                ],
                "outgoingFriendRequestIds": [
                    "occaecat Lorem in",
                    "occaecat Lorem in",
                    "occaecat Lorem in"
                ],
                "incomingFriendRequestIds": [
                    "occaecat Lorem in",
                    "occaecat Lorem in",
                    "occaecat Lorem in"
                ],
                "ignoreIds": [
                    "occaecat Lorem in",
                    "occaecat Lorem in",
                    "occaecat Lorem in"
                ]
            },
            {
                "userId": "f47a7e1e-4b2f-4d3d-3f3c-1f0f0e4b7e1e",
                "username": "occaecat Lorem in",
                "displayName": "occaecat Lorem in",
                "clanId": "occaecat Lorem in",
                "partyId": "occaecat Lorem in",
                "scopes": [
                    "occaecat Lorem in",
                    "occaecat Lorem in",
                    "occaecat Lorem in"
                ],
                "countryCode": "occaecat Lorem in",
                "status": "menu",
                "battleStatus": {
                    "battleId": "occaecat Lorem in",
                    "isSpectator": true,
                    "userId": {},
                    "name": "occaecat Lorem in",
                    "rank": -20000000,
                    "countryCode": "occaecat Lorem in"
                },
                "friendIds": [
                    "occaecat Lorem in",
                    "occaecat Lorem in",
                    "occaecat Lorem in"
                ],
                "outgoingFriendRequestIds": [
                    "occaecat Lorem in",
                    "occaecat Lorem in",
                    "occaecat Lorem in"
                ],
                "incomingFriendRequestIds": [
                    "occaecat Lorem in",
                    "occaecat Lorem in",
                    "occaecat Lorem in"
                ],
                "ignoreIds": [
                    "occaecat Lorem in",
                    "occaecat Lorem in",
                    "occaecat Lorem in"
                ]
            }
        ]
    }
}
```
</details>

#### TypeScript Definition
```ts
export type PrivateUser = {
    userId: UserId;
    username: string;
    displayName: string;
    clanId: string | null;
    partyId: string | null;
    scopes: string[];
    countryCode?: string;
    status: "offline" | "menu" | "playing" | "lobby";
    battleStatus: BattleStatus;
} & {
    friendIds: string[];
    outgoingFriendRequestIds: string[];
    incomingFriendRequestIds: string[];
    ignoreIds: string[];
};
export type UserId = string;
export type BattleStatus =
    | ({
          battleId: string;
      } & (
          | ({
                isSpectator: true;
            } & {
                userId: UserId;
                name: string;
                rank: number;
                countryCode: string;
            })
          | ({
                isSpectator: false;
            } & Player)
      ))
    | null;
export type Player = Spectator & {
    customOptions?: {
        [k: string]: string;
    };
};

export interface UserAddEvent {
    type: "event";
    messageId: string;
    commandId: "user/add";
    data: UserAddEventData;
}
export interface UserAddEventData {
    users: PrivateUser[];
}
export interface Spectator {
    userId: UserId;
    name: string;
    rank: number;
    countryCode: string;
}
```
---

## Update

Sent by the server to inform the client when subscribed users get updated in some way. The root object of each array element in `users` are partial, meaning only the elements present have changed, and anything missing is assumed to be unchanged. This event should precede the [add](#add) event which contains the full, initial state of users.

- Endpoint Type: **Event**
- Source: **Server**
- Target: **User**
- Required Scopes: `tachyon.lobby`

### Event

<details>
<summary>JSONSchema</summary>

```json
{
    "title": "UserUpdateEvent",
    "scopes": [
        "tachyon.lobby"
    ],
    "type": "object",
    "properties": {
        "type": {
            "const": "event",
            "type": "string"
        },
        "messageId": {
            "type": "string"
        },
        "commandId": {
            "const": "user/update",
            "type": "string"
        },
        "data": {
            "type": "object",
            "properties": {
                "users": {
                    "type": "array",
                    "items": {
                        "allOf": [
                            {
                                "type": "object",
                                "properties": {}
                            },
                            {
                                "type": "object",
                                "properties": {
                                    "friendIds": {
                                        "type": "array",
                                        "items": {
                                            "type": "string"
                                        }
                                    },
                                    "outgoingFriendRequestIds": {
                                        "type": "array",
                                        "items": {
                                            "type": "string"
                                        }
                                    },
                                    "incomingFriendRequestIds": {
                                        "type": "array",
                                        "items": {
                                            "type": "string"
                                        }
                                    },
                                    "ignoreIds": {
                                        "type": "array",
                                        "items": {
                                            "type": "string"
                                        }
                                    }
                                }
                            }
                        ],
                        "type": "object"
                    }
                }
            },
            "required": [
                "users"
            ],
            "title": "UserUpdateEventData"
        }
    },
    "required": [
        "type",
        "messageId",
        "commandId",
        "data"
    ]
}
```
</details>

<details>
<summary>Example</summary>

```json
{
    "type": "event",
    "messageId": "pariatur Lorem reprehenderit",
    "commandId": "user/update",
    "data": {
        "users": [
            {
                "friendIds": [
                    "pariatur Lorem reprehenderit",
                    "pariatur Lorem reprehenderit",
                    "pariatur Lorem reprehenderit"
                ],
                "incomingFriendRequestIds": [
                    "pariatur Lorem reprehenderit",
                    "pariatur Lorem reprehenderit",
                    "pariatur Lorem reprehenderit"
                ],
                "ignoreIds": [
                    "pariatur Lorem reprehenderit",
                    "pariatur Lorem reprehenderit",
                    "pariatur Lorem reprehenderit"
                ]
            },
            {
                "friendIds": [
                    "pariatur Lorem reprehenderit",
                    "pariatur Lorem reprehenderit",
                    "pariatur Lorem reprehenderit"
                ],
                "incomingFriendRequestIds": [
                    "pariatur Lorem reprehenderit",
                    "pariatur Lorem reprehenderit",
                    "pariatur Lorem reprehenderit"
                ],
                "ignoreIds": [
                    "pariatur Lorem reprehenderit",
                    "pariatur Lorem reprehenderit",
                    "pariatur Lorem reprehenderit"
                ]
            },
            {
                "friendIds": [
                    "pariatur Lorem reprehenderit",
                    "pariatur Lorem reprehenderit",
                    "pariatur Lorem reprehenderit"
                ],
                "incomingFriendRequestIds": [
                    "pariatur Lorem reprehenderit",
                    "pariatur Lorem reprehenderit",
                    "pariatur Lorem reprehenderit"
                ],
                "ignoreIds": [
                    "pariatur Lorem reprehenderit",
                    "pariatur Lorem reprehenderit",
                    "pariatur Lorem reprehenderit"
                ]
            }
        ]
    }
}
```
</details>

#### TypeScript Definition
```ts
export interface UserUpdateEvent {
    type: "event";
    messageId: string;
    commandId: "user/update";
    data: UserUpdateEventData;
}
export interface UserUpdateEventData {
    users: ({} & {
        friendIds?: string[];
        outgoingFriendRequestIds?: string[];
        incomingFriendRequestIds?: string[];
        ignoreIds?: string[];
    })[];
}
```
