<!-- THIS FILE IS AUTOMATICALLY GENERATED, PLEASE DO NOT EDIT IT MANUALLY -->

# User

- [add](#add)
- [update](#update)
---

## Add

Contains the full state of users that the client has just subscribed to. This event should always precede [update](#update) events which contain partial updates of how users have changed.

- Endpoint Type: **Event**
- Source: **Server**
- Target: **User**
- Required Scopes: `tachyon.lobby`

### Event

<details>
<summary>JSONSchema</summary>

```json
{
    "title": "UserAddEvent",
    "tachyon": {
        "source": "server",
        "target": "user",
        "scopes": ["tachyon.lobby"]
    },
    "type": "object",
    "properties": {
        "type": { "const": "event" },
        "messageId": { "type": "string" },
        "commandId": { "const": "user/add" },
        "data": {
            "title": "UserAddEventData",
            "type": "object",
            "properties": {
                "users": {
                    "type": "array",
                    "items": { "$ref": "../../definitions/user.json" }
                }
            },
            "required": ["users"]
        }
    },
    "required": ["type", "messageId", "commandId", "data"]
}

```
</details>

#### TypeScript Definition
```ts
export type UserId = string;
export type BattleStatus =
    | ({
          battleId: string;
      } & ({
          isSpectator: boolean;
      } & Player))
    | null;

export interface UserAddEvent {
    type: "event";
    messageId: string;
    commandId: "user/add";
    data: UserAddEventData;
}
export interface UserAddEventData {
    users: User[];
}
export interface User {
    userId: UserId;
    username: string;
    displayName: string;
    clanId: string | null;
    partyId: string | null;
    scopes: string[];
    countryCode?: string;
    status: "offline" | "menu" | "playing" | "lobby";
    battleStatus: BattleStatus;
}
export interface Player {
    userId: UserId;
    name: string;
    password: string;
    rank?: number;
    countryCode?: string;
    customProperties?: CustomStartScriptProperties;
}
export interface CustomStartScriptProperties {
    [k: string]: string;
}
```
---

## Update

Sent by the server to inform the client when subscribed users get updated in some way. The root object of each array element in `users` are partial, meaning only the elements present have changed, and anything missing is assumed to be unchanged. This event should precede the [add](#add) event which contains the full, initial state of users.

- Endpoint Type: **Event**
- Source: **Server**
- Target: **User**
- Required Scopes: `tachyon.lobby`

### Event

<details>
<summary>JSONSchema</summary>

```json
{
    "title": "UserUpdateEvent",
    "tachyon": {
        "source": "server",
        "target": "user",
        "scopes": ["tachyon.lobby"]
    },
    "type": "object",
    "properties": {
        "type": { "const": "event" },
        "messageId": { "type": "string" },
        "commandId": { "const": "user/update" },
        "data": {
            "title": "UserUpdateEventData",
            "type": "object",
            "properties": {
                "users": {
                    "type": "array",
                    "items": {
                        "type": "object",
                        "properties": {
                            "userId": {
                                "$ref": "../../definitions/userId.json"
                            },
                            "username": { "type": "string" },
                            "displayName": { "type": "string" },
                            "clanId": {
                                "anyOf": [
                                    { "type": "string" },
                                    { "type": "null" }
                                ]
                            },
                            "partyId": {
                                "anyOf": [
                                    { "type": "string" },
                                    { "type": "null" }
                                ]
                            },
                            "scopes": {
                                "type": "array",
                                "items": { "type": "string" }
                            },
                            "countryCode": { "type": "string" },
                            "status": {
                                "anyOf": [
                                    { "const": "offline" },
                                    { "const": "menu" },
                                    { "const": "playing" },
                                    { "const": "lobby" }
                                ]
                            },
                            "battleStatus": {
                                "$ref": "../../definitions/battleStatus.json"
                            }
                        }
                    }
                }
            },
            "required": ["users"]
        }
    },
    "required": ["type", "messageId", "commandId", "data"]
}

```
</details>

#### TypeScript Definition
```ts
export type UserId = string;
export type BattleStatus =
    | ({
          battleId: string;
      } & ({
          isSpectator: boolean;
      } & Player))
    | null;

export interface UserUpdateEvent {
    type: "event";
    messageId: string;
    commandId: "user/update";
    data: UserUpdateEventData;
}
export interface UserUpdateEventData {
    users: {
        userId?: UserId;
        username?: string;
        displayName?: string;
        clanId?: string | null;
        partyId?: string | null;
        scopes?: string[];
        countryCode?: string;
        status?: "offline" | "menu" | "playing" | "lobby";
        battleStatus?: BattleStatus;
    }[];
}
export interface Player {
    userId: UserId;
    name: string;
    password: string;
    rank?: number;
    countryCode?: string;
    customProperties?: CustomStartScriptProperties;
}
export interface CustomStartScriptProperties {
    [k: string]: string;
}
```
